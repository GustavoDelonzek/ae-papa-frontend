<div class="caretaker-register-container">
  <app-sidebar></app-sidebar>
  
  <div class="main-content">
    
    <div class="form-container">
      <div class="content-header">
        <h1 class="page-title">{{ isEditing ? 'Editar Cuidador' : 'Cadastro de Cuidador' }}</h1>
        <p class="page-subtitle">{{ isEditing ? 'Atualize os dados do cuidador e salve.' : 'Preencha os dados do cuidador para realizar o cadastro' }}</p>
      </div>
      <form class="caretaker-form" (ngSubmit)="onSubmit()" #caretakerForm="ngForm" novalidate>
        
        <!-- Nome Completo -->
        <div class="form-group">
          <label for="full_name" class="form-label">Nome Completo *</label>
          <input 
            type="text" 
            id="full_name"
            name="full_name"
            class="form-control"
            [(ngModel)]="caretakerData.full_name"
            required
            maxlength="255"
            #fullName="ngModel"
            placeholder="Digite o nome completo do cuidador">
          
          <div *ngIf="fullName.invalid && fullName.touched" class="error-message">
            <small *ngIf="fullName.errors?.['required']" class="text-danger">
              Nome completo é obrigatório
            </small>
          </div>
        </div>

        <!-- CPF -->
        <div class="form-group">
          <label for="cpf" class="form-label">CPF *</label>
          <input 
            type="text" 
            id="cpf"
            name="cpf"
            class="form-control"
            [(ngModel)]="caretakerData.cpf"
            (input)="formatCPF($any($event.target).value)"
            required
            maxlength="14"
            #cpf="ngModel"
            placeholder="000.000.000-00">
          
          <div *ngIf="cpf.invalid && cpf.touched" class="error-message">
            <small *ngIf="cpf.errors?.['required']" class="text-danger">
              CPF é obrigatório
            </small>
          </div>
        </div>

        <!-- RG -->
        <div class="form-group">
          <label for="rg" class="form-label">RG</label>
          <input 
            type="text" 
            id="rg"
            name="rg"
            class="form-control"
            [(ngModel)]="caretakerData.rg"
            maxlength="20"
            placeholder="Digite o RG (opcional)">
        </div>

        <!-- Data de Nascimento -->
        <div class="form-group">
          <label for="birth_date" class="form-label">Data de Nascimento *</label>
          <input 
            type="date" 
            id="birth_date"
            name="birth_date"
            class="form-control"
            [(ngModel)]="caretakerData.birth_date"
            required
            #birthDate="ngModel">
          
          <div *ngIf="birthDate.invalid && birthDate.touched" class="error-message">
            <small *ngIf="birthDate.errors?.['required']" class="text-danger">
              Data de nascimento é obrigatória
            </small>
          </div>
        </div>

        <!-- Gênero -->
        <div class="form-group">
          <label for="gender" class="form-label">Gênero *</label>
          <select 
            id="gender"
            name="gender"
            class="form-control"
            [(ngModel)]="caretakerData.gender"
            required
            #gender="ngModel">
            <option value="">Selecione o gênero</option>
            <option value="M">Masculino</option>
            <option value="F">Feminino</option>
          </select>
          
          <div *ngIf="gender.invalid && gender.touched" class="error-message">
            <small *ngIf="gender.errors?.['required']" class="text-danger">
              Gênero é obrigatório
            </small>
          </div>
        </div>

        <!-- Estado Civil -->
        <div class="form-group">
          <label for="marital_status" class="form-label">Estado Civil *</label>
          <select 
            id="marital_status"
            name="marital_status"
            class="form-control"
            [(ngModel)]="caretakerData.marital_status"
            required
            #maritalStatus="ngModel">
            <option value="">Selecione o estado civil</option>
            <option value="single">Solteiro(a)</option>
            <option value="married">Casado(a)</option>
            <option value="divorced">Divorciado(a)</option>
            <option value="widowed">Viúvo(a)</option>
          </select>
          
          <div *ngIf="maritalStatus.invalid && maritalStatus.touched" class="error-message">
            <small *ngIf="maritalStatus.errors?.['required']" class="text-danger">
              Estado civil é obrigatório
            </small>
          </div>
        </div>

        <!-- Parentesco -->
        <div class="form-group">
          <label for="relationship" class="form-label">Parentesco/Relação</label>
          <select 
            id="relationship"
            name="relationship"
            class="form-control"
            [(ngModel)]="caretakerData.relationship">
            <option value="">Selecione o parentesco</option>
            <option value="son">Filho</option>
            <option value="daughter">Filha</option>
            <option value="spouse">Cônjuge</option>
            <option value="partner">Companheiro(a)</option>
            <option value="father">Pai</option>
            <option value="mother">Mãe</option>
            <option value="brother">Irmão</option>
            <option value="sister">Irmã</option>
            <option value="grand_son">Neto</option>
            <option value="grand_daughter">Neta</option>
            <option value="nephew">Sobrinho</option>
            <option value="niece">Sobrinha</option>
            <option value="friend">Amigo(a)</option>
            <option value="professional_caregiver">Cuidador Profissional</option>
            <option value="other">Outro</option>
          </select>
        </div>

        <!-- ID do Paciente -->
        <div class="form-group">
          <label for="patient_id" class="form-label">ID do Paciente *</label>
          <input 
            type="number" 
            id="patient_id"
            name="patient_id"
            class="form-control"
            [(ngModel)]="caretakerData.patient_id"
            placeholder="Digite o ID do paciente"
            required
            min="1"
            #patientId="ngModel">
          
          <div *ngIf="patientId.invalid && patientId.touched" class="error-message">
            <small *ngIf="patientId.errors?.['required']" class="text-danger">
              ID do paciente é obrigatório
            </small>
          </div>
        </div>

        <!-- Mensagens de Erro/Sucesso -->
        <div *ngIf="errorMessage" class="alert alert-danger">
          <i class="fas fa-exclamation-circle"></i> {{ errorMessage }}
        </div>
        <div *ngIf="successMessage" class="alert alert-success">
          <i class="fas fa-check-circle"></i> {{ successMessage }}
        </div>

        <!-- Botões de Ação -->
        <div class="form-actions">
          <button 
            type="button" 
            class="btn-cancel"
            (click)="onCancel()"
            [disabled]="isLoading">
            <i class="fas fa-times"></i> Cancelar
          </button>
          <button 
            type="submit" 
            class="btn-submit"
            [disabled]="isLoading || !caretakerForm.valid">
            <span *ngIf="isLoading">
              <i class="fas fa-spinner fa-spin"></i> {{ isEditing ? 'Atualizando...' : 'Cadastrando...' }}
            </span>
            <span *ngIf="!isLoading">
              <i class="fas fa-save"></i> {{ isEditing ? 'Atualizar Cuidador' : 'Cadastrar Cuidador' }}
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

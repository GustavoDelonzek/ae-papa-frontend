<div class="modal-backdrop" (click)="close()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Upload de Documento</h2>
      <button class="btn-close" (click)="close()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="modal-body">
      <!-- Error message -->
      <div class="alert alert-error" *ngIf="errorMessage">
        <i class="fas fa-exclamation-circle"></i>
        {{ errorMessage }}
      </div>

      <!-- File drop zone -->
      <div 
        class="drop-zone" 
        [class.drag-over]="dragOver"
        [class.has-file]="selectedFile"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        (click)="fileInput.click()">
        
        <div class="drop-zone-content" *ngIf="!selectedFile">
          <i class="fas fa-cloud-upload-alt"></i>
          <p class="drop-text">Arraste e solte o arquivo aqui</p>
          <p class="drop-text-or">ou</p>
          <button class="btn-select-file" type="button">
            <i class="fas fa-folder-open"></i> Selecionar Arquivo
          </button>
          <p class="file-requirements">PDF, JPG, JPEG ou PNG (máx. 5MB)</p>
        </div>

        <div class="selected-file" *ngIf="selectedFile">
          <i class="fas file-icon" [ngClass]="getFileIcon()"></i>
          <div class="file-info">
            <p class="file-name">{{ selectedFile.name }}</p>
            <p class="file-size">{{ getFileSize() }}</p>
          </div>
          <button class="btn-remove-file" type="button" (click)="removeFile(); $event.stopPropagation()">
            <i class="fas fa-trash"></i>
          </button>
        </div>

        <input 
          #fileInput 
          type="file" 
          accept=".pdf,.jpg,.jpeg,.png"
          (change)="onFileSelected($event)"
          style="display: none;">
      </div>

      <!-- Form fields -->
      <div class="form-group">
        <label for="fileName">Nome do Documento *</label>
        <input 
          id="fileName"
          type="text" 
          [(ngModel)]="fileName"
          placeholder="Ex: Exame de sangue - Janeiro 2026"
          [disabled]="uploading"
          required>
      </div>

      <div class="form-group">
        <label for="documentType">Tipo de Documento</label>
        <input 
          id="documentType"
          type="text" 
          [(ngModel)]="documentType"
          placeholder="Ex: Exame, Laudo, Receita"
          [disabled]="uploading">
      </div>

      <div class="form-group">
        <label for="description">Descrição</label>
        <textarea 
          id="description"
          [(ngModel)]="description"
          placeholder="Adicione uma descrição ou observação sobre o documento"
          rows="3"
          [disabled]="uploading"></textarea>
      </div>
    </div>

    <div class="modal-footer">
      <button 
        class="btn-cancel" 
        (click)="close()"
        [disabled]="uploading">
        Cancelar
      </button>
      <button 
        class="btn-upload" 
        (click)="uploadDocument()"
        [disabled]="!selectedFile || !fileName.trim() || uploading">
        <i class="fas" [ngClass]="uploading ? 'fa-spinner fa-spin' : 'fa-upload'"></i>
        {{ uploading ? 'Enviando...' : 'Enviar Documento' }}
      </button>
    </div>
  </div>
</div>
